{
	"Golang errors": {},
	"Issues": [
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion uintptr -\u003e int",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/vault_token.go",
			"code": "110: \tfmt.Fprint(os.Stderr, \"Vault root token: \")\n111: \tbytes, err := term.ReadPassword(int(os.Stdin.Fd()))\n112: \tfmt.Fprintln(os.Stderr)\n",
			"line": "111",
			"column": "37",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion uintptr -\u003e int",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/vault_token.go",
			"code": "96: func readVaultToken() (string, error) {\n97: \tstdinIsTerminal := term.IsTerminal(int(os.Stdin.Fd()))\n98: \tif !stdinIsTerminal {\n",
			"line": "97",
			"column": "40",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "LOW",
			"cwe": {
				"id": "798",
				"url": "https://cwe.mitre.org/data/definitions/798.html"
			},
			"rule_id": "G101",
			"details": "Potential hardcoded credentials",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/k8s/secrets.go",
			"code": "46: \t\t\tNamespace: \"argocd\",\n47: \t\t\tLabels: map[string]string{\n48: \t\t\t\t\"argocd.argoproj.io/secret-type\": \"repo-creds\", //nolint:gosec // safe: Kubernetes labels are not credentials\n49: \t\t\t},\n50: \t\t\tAnnotations: map[string]string{\n",
			"line": "47-49",
			"column": "12",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "LOW",
			"cwe": {
				"id": "798",
				"url": "https://cwe.mitre.org/data/definitions/798.html"
			},
			"rule_id": "G101",
			"details": "Potential hardcoded credentials",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/bootstrap.go",
			"code": "286: \t\t\t\"namespace\": \"argocd\",\n287: \t\t\t\"labels\": map[string]string{\n288: \t\t\t\t\"argocd.argoproj.io/secret-type\": \"repo-creds\", //nolint:gosec // safe: Kubernetes labels are not credentials\n289: \t\t\t},\n290: \t\t\t\"annotations\": map[string]string{\n",
			"line": "287-289",
			"column": "14",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "78",
				"url": "https://cwe.mitre.org/data/definitions/78.html"
			},
			"rule_id": "G204",
			"details": "Subprocess launched with variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/preflight.go",
			"code": "109: \n110: \tcmd := exec.Command(path, \"--version\") //nolint:gosec // safe: path validated by exec.LookPath\n111: \terr = cmd.Run()\n",
			"line": "110",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "78",
				"url": "https://cwe.mitre.org/data/definitions/78.html"
			},
			"rule_id": "G204",
			"details": "Subprocess launched with variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/preflight.go",
			"code": "84: \n85: \tcmd := exec.Command(path, \"--version\") //nolint:gosec // safe: path validated by exec.LookPath\n86: \terr = cmd.Run()\n",
			"line": "85",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "78",
				"url": "https://cwe.mitre.org/data/definitions/78.html"
			},
			"rule_id": "G204",
			"details": "Subprocess launched with variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/preflight.go",
			"code": "64: \t}\n65: \tcmd := exec.Command(path, \"--version\") //nolint:gosec // safe: path validated by exec.LookPath\n66: \terr = cmd.Run()\n",
			"line": "65",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "78",
				"url": "https://cwe.mitre.org/data/definitions/78.html"
			},
			"rule_id": "G204",
			"details": "Subprocess launched with variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/preflight.go",
			"code": "46: \t}\n47: \tcmd := exec.Command(path, \"version\", \"--short\") //nolint:gosec // safe: path validated by exec.LookPath\n48: \terr = cmd.Run()\n",
			"line": "47",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "78",
				"url": "https://cwe.mitre.org/data/definitions/78.html"
			},
			"rule_id": "G204",
			"details": "Subprocess launched with variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/preflight.go",
			"code": "32: \t}\n33: \tcmd := exec.Command(path, \"cluster-info\") //nolint:gosec // safe: path validated by exec.LookPath\n34: \toutput, err := cmd.CombinedOutput()\n",
			"line": "33",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/sops/decrypt.go",
			"code": "75: \t// Read plaintext\n76: \tdata, err := os.ReadFile(filePath) //nolint:gosec // safe: user-provided decryption input file\n77: \tif err != nil {\n",
			"line": "76",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/helm/argocd.go",
			"code": "47: \tchartPath := filepath.Join(baseDir, \"components/argocd/Chart.yaml\")\n48: \tdata, err := os.ReadFile(chartPath) //nolint:gosec // safe: filepath constructed with fixed baseDir\n49: \tif err != nil {\n",
			"line": "48",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/config/sops.go",
			"code": "24: func ReadSopsConfig(path string) (*SOPSConfig, error) {\n25: \tdata, err := os.ReadFile(path) //nolint:gosec // safe: user-provided secrets file from flag\n26: \tif err != nil {\n",
			"line": "25",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/config/secrets.go",
			"code": "57: func LoadSecretsPlaintext(filePath string) (*EnvironmentSecrets, error) {\n58: \tdata, err := os.ReadFile(filePath) //nolint:gosec // safe: user-provided secrets file from flag\n59: \tif err != nil {\n",
			"line": "58",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/config/gitcrypt.go",
			"code": "35: \n36: \tf, err := os.OpenFile(path, os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0600) //nolint:gosec // safe: user-provided gitcrypt key file from flag\n37: \tif err != nil {\n",
			"line": "36",
			"column": "12",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/internal/config/gitcrypt.go",
			"code": "17: \n18: \tdata, err := os.ReadFile(path) //nolint:gosec // safe: user-provided gitcrypt key file from flag\n19: \tif err != nil \u0026\u0026 !os.IsNotExist(err) {\n",
			"line": "18",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/init.go",
			"code": "357: \t// Read SSH key from filesystem\n358: \tsshKeyData, err := os.ReadFile(sshKeyPath) //nolint:gosec // safe: user-provided SSH key from flag\n359: \tif err != nil {\n",
			"line": "358",
			"column": "21",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/init.go",
			"code": "278: \t\tif ageKeyFile != \"\" {\n279: \t\t\tdata, err := os.ReadFile(ageKeyFile) //nolint:gosec // safe: user-provided age key file from flag\n280: \t\t\tif err != nil {\n",
			"line": "279",
			"column": "17",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/gitcrypt_key.go",
			"code": "33: func runGitCryptKey(cmd *cobra.Command, args []string) error {\n34: \tkeyData, err := os.ReadFile(gitCryptKeyFile) //nolint:gosec // safe: user-provided gitcrypt key file from flag\n35: \tif err != nil {\n",
			"line": "34",
			"column": "18",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/Users/ruicoelho/personal/repos/cluster-bootstrap/cli/cmd/bootstrap.go",
			"code": "180: \tif gitcryptKeyFile != \"\" {\n181: \t\tkeyData, err := os.ReadFile(gitcryptKeyFile) //nolint:gosec // safe: path comes from validated flag\n182: \t\tif err != nil {\n",
			"line": "181",
			"column": "19",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		}
	],
	"Stats": {
		"files": 20,
		"lines": 3370,
		"nosec": 0,
		"found": 19
	},
	"GosecVersion": "dev"
}
